# THIS FILE IS GENERATED WITH 'make generate' - DO NOT EDIT MANUALLY
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: machine-deployment-names
  annotations:
    policies.kyverno.io/title: Restrict names of MachineDeployments
    policies.kyverno.io/subject: MachineDeployments
    policies.kyverno.io/description: >-
      MachineDeployment names are of the form {CLUSTER_NAME}-{MD_NAME},
      therefore their total length must not exceed 21 (10 for CLUSTER_NAME
      and 10 for MACHINE_DEPLOYMENT_NAME).
      In addition they must never start with a number.
spec:
  validationFailureAction: Enforce
  rules:
  - name: machine-deployment-name-maximum-length
    match:
      any:
      - resources:
          kinds:
          - MachineDeployment
    validate:
      message: "machine deployment name must not be longer than 21 characters (10 for cluster name, 1 for '-', 10 for user defined named)"
      deny:
        conditions:
          any:
          - key: "{{ `{{` }} length('{{ `{{` }}request.object.metadata.name{{ `}}` }}') {{ `}}` }}"
            operator: GreaterThan
            value: 21
